'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends2 = require('babel-runtime/helpers/extends');

var _extends3 = _interopRequireDefault(_extends2);

var _regenerator = require('babel-runtime/regenerator');

var _regenerator2 = _interopRequireDefault(_regenerator);

var _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _propTypes = require('prop-types');

var _propTypes2 = _interopRequireDefault(_propTypes);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _Composer = require('./Composer');

var _Composer2 = _interopRequireDefault(_Composer);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var SayButton = function (_React$Component) {
  (0, _inherits3.default)(SayButton, _React$Component);

  function SayButton(props) {
    (0, _classCallCheck3.default)(this, SayButton);

    var _this = (0, _possibleConstructorReturn3.default)(this, (SayButton.__proto__ || (0, _getPrototypeOf2.default)(SayButton)).call(this, props));

    _this.handleClick = _this.handleClick.bind(_this);

    _this.state = {
      busy: false,
      id: Date.now() + Math.random()
    };
    return _this;
  }

  (0, _createClass3.default)(SayButton, [{
    key: 'componentWillUnmount',
    value: function componentWillUnmount() {
      this.props.context.cancel(this.state.id);
    }
  }, {
    key: 'handleClick',
    value: function handleClick() {
      var _this2 = this;

      var props = this.props,
          state = this.state;


      props.onClick && props.onClick(event);

      this.setState(function () {
        return { busy: true };
      }, (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {
        return _regenerator2.default.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return props.context.speak({
                  id: state.id,
                  lang: props.lang,
                  onBoundary: props.onBoundary,
                  onEnd: props.onEnd,
                  onError: props.onError,
                  onStart: props.onStart,
                  pitch: props.pitch,
                  rate: props.rate,
                  text: props.speak,
                  voice: props.voice,
                  volume: props.volume
                });

              case 2:

                _this2.setState(function () {
                  return {
                    busy: false
                  };
                });

              case 3:
              case 'end':
                return _context.stop();
            }
          }
        }, _callee, _this2);
      })));
    }
  }, {
    key: 'render',
    value: function render() {
      var _props = this.props,
          children = _props.children,
          disabled = _props.disabled,
          busy = this.state.busy;


      return _react2.default.createElement(
        'button',
        {
          disabled: typeof disabled === 'boolean' ? disabled : busy,
          onClick: this.handleClick
        },
        children
      );
    }
  }]);
  return SayButton;
}(_react2.default.Component);

var SayButtonWithContext = function SayButtonWithContext(props) {
  return _react2.default.createElement(
    _Composer2.default,
    {
      speechSynthesis: props.speechSynthesis,
      speechSynthesisUtterance: props.speechSynthesisUtterance
    },
    function (context) {
      return _react2.default.createElement(SayButton, (0, _extends3.default)({ context: context }, props));
    }
  );
};

SayButtonWithContext.propTypes = {
  lang: _propTypes2.default.string,
  onBoundary: _propTypes2.default.func,
  onEnd: _propTypes2.default.func,
  onError: _propTypes2.default.func,
  onStart: _propTypes2.default.func,
  pitch: _propTypes2.default.number,
  rate: _propTypes2.default.number,
  speak: _propTypes2.default.string,
  voice: _propTypes2.default.oneOfType([_propTypes2.default.any, _propTypes2.default.func]),
  volume: _propTypes2.default.number
};

exports.default = SayButtonWithContext;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9TYXlCdXR0b24uanMiXSwibmFtZXMiOlsiU2F5QnV0dG9uIiwicHJvcHMiLCJoYW5kbGVDbGljayIsImJpbmQiLCJzdGF0ZSIsImJ1c3kiLCJpZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwiY29udGV4dCIsImNhbmNlbCIsIm9uQ2xpY2siLCJldmVudCIsInNldFN0YXRlIiwic3BlYWsiLCJsYW5nIiwib25Cb3VuZGFyeSIsIm9uRW5kIiwib25FcnJvciIsIm9uU3RhcnQiLCJwaXRjaCIsInJhdGUiLCJ0ZXh0Iiwidm9pY2UiLCJ2b2x1bWUiLCJjaGlsZHJlbiIsImRpc2FibGVkIiwiUmVhY3QiLCJDb21wb25lbnQiLCJTYXlCdXR0b25XaXRoQ29udGV4dCIsInNwZWVjaFN5bnRoZXNpcyIsInNwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZSIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsInN0cmluZyIsImZ1bmMiLCJudW1iZXIiLCJvbmVPZlR5cGUiLCJhbnkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7Ozs7QUFDQTs7OztBQUVBOzs7Ozs7SUFFTUEsUzs7O0FBQ0oscUJBQVlDLEtBQVosRUFBbUI7QUFBQTs7QUFBQSw0SUFDWEEsS0FEVzs7QUFHakIsVUFBS0MsV0FBTCxHQUFtQixNQUFLQSxXQUFMLENBQWlCQyxJQUFqQixPQUFuQjs7QUFFQSxVQUFLQyxLQUFMLEdBQWE7QUFDWEMsWUFBTSxLQURLO0FBRVhDLFVBQUlDLEtBQUtDLEdBQUwsS0FBYUMsS0FBS0MsTUFBTDtBQUZOLEtBQWI7QUFMaUI7QUFTbEI7Ozs7MkNBRXNCO0FBQ3JCLFdBQUtULEtBQUwsQ0FBV1UsT0FBWCxDQUFtQkMsTUFBbkIsQ0FBMEIsS0FBS1IsS0FBTCxDQUFXRSxFQUFyQztBQUNEOzs7a0NBRWE7QUFBQTs7QUFBQSxVQUNKTCxLQURJLEdBQ2EsSUFEYixDQUNKQSxLQURJO0FBQUEsVUFDR0csS0FESCxHQUNhLElBRGIsQ0FDR0EsS0FESDs7O0FBR1pILFlBQU1ZLE9BQU4sSUFBaUJaLE1BQU1ZLE9BQU4sQ0FBY0MsS0FBZCxDQUFqQjs7QUFFQSxXQUFLQyxRQUFMLENBQWM7QUFBQSxlQUFPLEVBQUVWLE1BQU0sSUFBUixFQUFQO0FBQUEsT0FBZCwyRUFBc0M7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQzlCSixNQUFNVSxPQUFOLENBQWNLLEtBQWQsQ0FBb0I7QUFDeEJWLHNCQUFJRixNQUFNRSxFQURjO0FBRXhCVyx3QkFBTWhCLE1BQU1nQixJQUZZO0FBR3hCQyw4QkFBWWpCLE1BQU1pQixVQUhNO0FBSXhCQyx5QkFBT2xCLE1BQU1rQixLQUpXO0FBS3hCQywyQkFBU25CLE1BQU1tQixPQUxTO0FBTXhCQywyQkFBU3BCLE1BQU1vQixPQU5TO0FBT3hCQyx5QkFBT3JCLE1BQU1xQixLQVBXO0FBUXhCQyx3QkFBTXRCLE1BQU1zQixJQVJZO0FBU3hCQyx3QkFBTXZCLE1BQU1lLEtBVFk7QUFVeEJTLHlCQUFPeEIsTUFBTXdCLEtBVlc7QUFXeEJDLDBCQUFRekIsTUFBTXlCO0FBWFUsaUJBQXBCLENBRDhCOztBQUFBOztBQWVwQyx1QkFBS1gsUUFBTCxDQUFjO0FBQUEseUJBQU87QUFDbkJWLDBCQUFNO0FBRGEsbUJBQVA7QUFBQSxpQkFBZDs7QUFmb0M7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsT0FBdEM7QUFtQkQ7Ozs2QkFFUTtBQUFBLG1CQUlILElBSkcsQ0FFTEosS0FGSztBQUFBLFVBRUkwQixRQUZKLFVBRUlBLFFBRko7QUFBQSxVQUVjQyxRQUZkLFVBRWNBLFFBRmQ7QUFBQSxVQUdJdkIsSUFISixHQUlILElBSkcsQ0FHTEQsS0FISyxDQUdJQyxJQUhKOzs7QUFNUCxhQUNFO0FBQUE7QUFBQTtBQUNFLG9CQUFXLE9BQU91QixRQUFQLEtBQW9CLFNBQXBCLEdBQWdDQSxRQUFoQyxHQUEyQ3ZCLElBRHhEO0FBRUUsbUJBQVUsS0FBS0g7QUFGakI7QUFJSXlCO0FBSkosT0FERjtBQVFEOzs7RUF4RHFCRSxnQkFBTUMsUzs7QUEyRDlCLElBQU1DLHVCQUF1QixTQUF2QkEsb0JBQXVCO0FBQUEsU0FDM0I7QUFBQyxzQkFBRDtBQUFBO0FBQ0UsdUJBQWtCOUIsTUFBTStCLGVBRDFCO0FBRUUsZ0NBQTJCL0IsTUFBTWdDO0FBRm5DO0FBSUk7QUFBQSxhQUNBLDhCQUFDLFNBQUQsMkJBQVcsU0FBVXRCLE9BQXJCLElBQW9DVixLQUFwQyxFQURBO0FBQUE7QUFKSixHQUQyQjtBQUFBLENBQTdCOztBQVVBOEIscUJBQXFCRyxTQUFyQixHQUFpQztBQUMvQmpCLFFBQU1rQixvQkFBVUMsTUFEZTtBQUUvQmxCLGNBQVlpQixvQkFBVUUsSUFGUztBQUcvQmxCLFNBQU9nQixvQkFBVUUsSUFIYztBQUkvQmpCLFdBQVNlLG9CQUFVRSxJQUpZO0FBSy9CaEIsV0FBU2Msb0JBQVVFLElBTFk7QUFNL0JmLFNBQU9hLG9CQUFVRyxNQU5jO0FBTy9CZixRQUFNWSxvQkFBVUcsTUFQZTtBQVEvQnRCLFNBQU9tQixvQkFBVUMsTUFSYztBQVMvQlgsU0FBT1Usb0JBQVVJLFNBQVYsQ0FBb0IsQ0FBQ0osb0JBQVVLLEdBQVgsRUFBZ0JMLG9CQUFVRSxJQUExQixDQUFwQixDQVR3QjtBQVUvQlgsVUFBUVMsb0JBQVVHO0FBVmEsQ0FBakM7O2tCQWFlUCxvQiIsImZpbGUiOiJTYXlCdXR0b24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IENvbXBvc2VyIGZyb20gJy4vQ29tcG9zZXInO1xuXG5jbGFzcyBTYXlCdXR0b24gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcblxuICAgIHRoaXMuaGFuZGxlQ2xpY2sgPSB0aGlzLmhhbmRsZUNsaWNrLmJpbmQodGhpcyk7XG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgYnVzeTogZmFsc2UsXG4gICAgICBpZDogRGF0ZS5ub3coKSArIE1hdGgucmFuZG9tKClcbiAgICB9O1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgdGhpcy5wcm9wcy5jb250ZXh0LmNhbmNlbCh0aGlzLnN0YXRlLmlkKTtcbiAgfVxuXG4gIGhhbmRsZUNsaWNrKCkge1xuICAgIGNvbnN0IHsgcHJvcHMsIHN0YXRlIH0gPSB0aGlzO1xuXG4gICAgcHJvcHMub25DbGljayAmJiBwcm9wcy5vbkNsaWNrKGV2ZW50KTtcblxuICAgIHRoaXMuc2V0U3RhdGUoKCkgPT4gKHsgYnVzeTogdHJ1ZSB9KSwgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgcHJvcHMuY29udGV4dC5zcGVhayh7XG4gICAgICAgIGlkOiBzdGF0ZS5pZCxcbiAgICAgICAgbGFuZzogcHJvcHMubGFuZyxcbiAgICAgICAgb25Cb3VuZGFyeTogcHJvcHMub25Cb3VuZGFyeSxcbiAgICAgICAgb25FbmQ6IHByb3BzLm9uRW5kLFxuICAgICAgICBvbkVycm9yOiBwcm9wcy5vbkVycm9yLFxuICAgICAgICBvblN0YXJ0OiBwcm9wcy5vblN0YXJ0LFxuICAgICAgICBwaXRjaDogcHJvcHMucGl0Y2gsXG4gICAgICAgIHJhdGU6IHByb3BzLnJhdGUsXG4gICAgICAgIHRleHQ6IHByb3BzLnNwZWFrLFxuICAgICAgICB2b2ljZTogcHJvcHMudm9pY2UsXG4gICAgICAgIHZvbHVtZTogcHJvcHMudm9sdW1lXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5zZXRTdGF0ZSgoKSA9PiAoe1xuICAgICAgICBidXN5OiBmYWxzZVxuICAgICAgfSkpO1xuICAgIH0pO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIHByb3BzOiB7IGNoaWxkcmVuLCBkaXNhYmxlZCB9LFxuICAgICAgc3RhdGU6IHsgYnVzeSB9XG4gICAgfSA9IHRoaXM7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGJ1dHRvblxuICAgICAgICBkaXNhYmxlZD17IHR5cGVvZiBkaXNhYmxlZCA9PT0gJ2Jvb2xlYW4nID8gZGlzYWJsZWQgOiBidXN5IH1cbiAgICAgICAgb25DbGljaz17IHRoaXMuaGFuZGxlQ2xpY2sgfVxuICAgICAgPlxuICAgICAgICB7IGNoaWxkcmVuIH1cbiAgICAgIDwvYnV0dG9uPlxuICAgICk7XG4gIH1cbn1cblxuY29uc3QgU2F5QnV0dG9uV2l0aENvbnRleHQgPSBwcm9wcyA9PlxuICA8Q29tcG9zZXJcbiAgICBzcGVlY2hTeW50aGVzaXM9eyBwcm9wcy5zcGVlY2hTeW50aGVzaXMgfVxuICAgIHNwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZT17IHByb3BzLnNwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZSB9XG4gID5cbiAgICB7IGNvbnRleHQgPT5cbiAgICAgIDxTYXlCdXR0b24gY29udGV4dD17IGNvbnRleHQgfSB7IC4uLnByb3BzIH0gLz5cbiAgICB9XG4gIDwvQ29tcG9zZXI+XG5cblNheUJ1dHRvbldpdGhDb250ZXh0LnByb3BUeXBlcyA9IHtcbiAgbGFuZzogUHJvcFR5cGVzLnN0cmluZyxcbiAgb25Cb3VuZGFyeTogUHJvcFR5cGVzLmZ1bmMsXG4gIG9uRW5kOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25FcnJvcjogUHJvcFR5cGVzLmZ1bmMsXG4gIG9uU3RhcnQ6IFByb3BUeXBlcy5mdW5jLFxuICBwaXRjaDogUHJvcFR5cGVzLm51bWJlcixcbiAgcmF0ZTogUHJvcFR5cGVzLm51bWJlcixcbiAgc3BlYWs6IFByb3BUeXBlcy5zdHJpbmcsXG4gIHZvaWNlOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuYW55LCBQcm9wVHlwZXMuZnVuY10pLFxuICB2b2x1bWU6IFByb3BUeXBlcy5udW1iZXJcbn07XG5cbmV4cG9ydCBkZWZhdWx0IFNheUJ1dHRvbldpdGhDb250ZXh0XG4iXX0=